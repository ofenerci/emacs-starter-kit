#+TITLE: My C++ projects by using EDE
* Настройка EDE
1. Для использования проектов необходимо включить соответствующий
   режим, реализуемый пакетом ~EDE~
   #+begin_src emacs-lisp
(global-ede-mode 1)
(ede-enable-generic-projects)
   #+end_src
2. Настройка команды компиляции для qt проекта
   #+begin_src emacs-lisp
(setq compilation-scroll-output 1)
(global-set-key (kbd "\e\em") 'save-and-make)
(global-set-key (kbd "\e\eq") 'save-and-qmake)
(global-set-key (kbd "\e\ec") 'save-and-cmake)
(global-set-key (kbd "\e\ek") 'kill-compilation)
(defun save-and-qmake ()
  "save and call compile as in ../build directory"
  (interactive)
  (save-buffer)
  (compile "cd ../build && qmake ../src")
  (message "qmake executed!"))
(defun save-and-cmake ()
  "save and call compile as cmake-gui in ../build directory"
  (interactive)
  (save-buffer)
  (compile "cd ../build && cmake-gui ../src"))
(defun save-and-make ()
  "save and call compile as make"
  (interactive)
  (save-buffer)
  (compile "make")
  (message "make executed!"))
   #+end_src
3. Настройка компиляции теневой сборки
   #+begin_src emacs-lisp
(defun svl/compile ()
  "Saves all unsaved buffers, and runs 'compile'."
  (interactive)
  (save-some-buffers t)
  (let* ((fname (or (buffer-file-name (current-buffer)) default-directory))
         (current-dir (file-name-directory fname))
         (prj (ede-current-project current-dir)))
    (if prj
        (project-compile-project prj)
        (compile compile-command))))
(global-set-key [f9] 'svl/compile)
   #+end_src
* Проект tooth
  #+begin_src emacs-lisp
(when (file-exists-p "~/Projects/tooth/src/all.pro")
 (setq mathdent-project
        (ede-cpp-root-project "tooth"
                              :name "tooth"
                              :file "~/Projects/tooth/src/all.pro"
                              :compile-command "cd ../build && qmake ../src/all.pro && make"
                              )))
  #+end_src

* Проект itksnap
  #+begin_src emacs-lisp
(when (file-exists-p "~/Projects/itk-snap/src/CMakeLists.txt")
 (setq itksnap-project
        (ede-cpp-root-project "itksnap"
                              :name "itksnap"
                              :file "~/Projects/itk-snap/src/CMakeLists.txt"
                              :system-include-path '("/usr/local/include/ITK-4.5")
                              :compile-command "cd ../build && make"
                              )))
  #+end_src
